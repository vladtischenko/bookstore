= render 'head'

%div.col-md-8
  %h4 CREDIT CARD
  -if current_user.credit_card
    = form_for current_user.credit_card do |f|
      %p
        = f.text_field :card_number, value: current_user.credit_card.card_number
        %br
      %p
        = f.label 'Expiration date:'
        %br
      %p
        = f.select :expiration_month, options_for_select(@months), selected: current_user.credit_card.expiration_month
        = f.select :expiration_year, options_for_select(@years), selected: current_user.credit_card.expiration_year
        %br
      %p
        = f.password_field :code, placeholder: 'Card Code'
        = link_to "(What's this)", 'http://en.wikipedia.org/wiki/Card_security_code'
        = f.hidden_field :user_id, value: current_user.id
        %br
      %p  
        = f.submit 'SAVE AND CONTINUE'
  -else
    = form_for CreditCard.new do |f|
      %p
        = f.text_field :card_number, placeholder: 'Card Number'
        %br
      %p
        = f.label 'Expiration date:'
        %br
      %p
        = f.select :expiration_month, options_for_select(@months, 'Month')
        = f.select :expiration_year, options_for_select(@years, 'Year')
        %br
      %p
        = f.password_field :code, placeholder: 'Card Code'
        = link_to "(What's this)", 'http://en.wikipedia.org/wiki/Card_security_code'
        = f.hidden_field :user_id, value: current_user.id
        %br
      %p  
        = f.submit 'SAVE AND CONTINUE'
  
%div
  %h4 ORDER SUMMARY
  %table
    %tr
      %td
        ITEM TOTAL: $
        = current_user.current_order.subtotal.round(2)
    %tr
      %td
        SHIPPING: $
        %span#shipping_value
          - if current_user.current_order.delivery
            = current_user.current_order.delivery.price.round(2)
          - else
            0.0
    %tr
      %td
        ORDER TOTAL: $
        = current_user.current_order.order_total.round(2)